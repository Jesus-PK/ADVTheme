<ResourceDictionary xmlns="https://github.com/avaloniaui"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:sys="using:System"
x:ClassModifier="internal">
	<Design.PreviewWith>
		<Border Padding="20" Width="400" Height="400">
			<Grid RowDefinitions="Auto,*">
				<Menu>
					<MenuItem Header="Test">
						<MenuItem Header="Test">
							<MenuItem Header="Test" IsEnabled="False"/>
							<MenuItem Header="Test" />
							<MenuItem Header="Test" />
						</MenuItem>
					</MenuItem>
					<MenuItem Header="Test">
						<MenuItem Header="Test" IsChecked="True"/>
						<MenuItem Header="Test" IsChecked="False"/>
						<MenuItem Header="Test" IsChecked="False"/>
					</MenuItem>
					<MenuItem Header="Test" IsEnabled="False"/>
				</Menu>
			</Grid>
		</Border>
	</Design.PreviewWith>

	<ControlTheme x:Key="SimpleTopLevelMenuItem" TargetType="MenuItem">
		<Setter Property="Background" Value="Transparent" />
		<Setter Property="BorderThickness" Value="1"/>
		<Setter Property="CornerRadius" Value="{DynamicResource ADVTheme.CornerRadius}"/>
		<Setter Property="Padding" Value="4, 1" />
		<Setter Property="Template">
			<ControlTemplate>
				<Border Name="PART_Border" Padding="{TemplateBinding Padding}"
						Background="{TemplateBinding Background}"
						BorderBrush="{TemplateBinding BorderBrush}"
						BorderThickness="{TemplateBinding BorderThickness}"
						CornerRadius="{TemplateBinding CornerRadius}">
					<Panel>
						<ContentPresenter Name="PART_HeaderPresenter"
										  Margin="{TemplateBinding Padding}"
										  Content="{TemplateBinding Header}"
										  ContentTemplate="{TemplateBinding HeaderTemplate}">
							<ContentPresenter.DataTemplates>
								<DataTemplate DataType="sys:String">
									<AccessText Text="{Binding}" />
								</DataTemplate>
							</ContentPresenter.DataTemplates>
						</ContentPresenter>
						<Popup Name="PART_Popup" IsLightDismissEnabled="True"
							   IsOpen="{TemplateBinding IsSubMenuOpen, Mode=TwoWay}"
							   Placement="BottomEdgeAlignedLeft"
							   OverlayInputPassThroughElement="{Binding $parent[Menu]}">
							<Border Background="{DynamicResource ADVTheme.Brush.Background.Base}"
									BorderBrush="{DynamicResource ADVTheme.Brush.Border.Base}"
									BorderThickness="1"
									CornerRadius="0">
								<ScrollViewer Theme="{StaticResource SimpleMenuScrollViewer}">
									<ItemsPresenter Name="PART_ItemsPresenter" Margin="2"
													Grid.IsSharedSizeScope="True" ItemsPanel="{TemplateBinding ItemsPanel}" />
								</ScrollViewer>
							</Border>
						</Popup>
					</Panel>
				</Border>
			</ControlTemplate>
		</Setter>

		<Style Selector="^:selected">
			<Setter Property="Foreground" Value="{DynamicResource ADVTheme.Palette.Foreground.Alt}"/>
			<Setter Property="Background" Value="{DynamicResource ADVTheme.Palette.Controls.Light}" />
			<Setter Property="BorderBrush" Value="{DynamicResource ADVTheme.Palette.Highlight.Base}" />
		</Style>

		<Style Selector="^:empty /template/ Path#rightArrow">
			<Setter Property="IsVisible" Value="False" />
		</Style>

		<Style Selector="^:disabled">
			<Setter Property="Opacity" Value="{DynamicResource ADVTheme.Opacity.Disabled}" />
		</Style>
	</ControlTheme>

	<ControlTheme x:Key="{x:Type Menu}"
			TargetType="Menu">
		<Setter Property="ItemContainerTheme" Value="{StaticResource SimpleTopLevelMenuItem}" />
		<Setter Property="Background" Value="{DynamicResource ADVTheme.Brush.Background.Base}"/>
		<Setter Property="BorderBrush" Value="{DynamicResource ADVTheme.Brush.Border.Base}"/>
		<Setter Property="Template">
			<ControlTemplate>
				<Border Padding="{TemplateBinding Padding}"
						Background="{TemplateBinding Background}"
						BorderBrush="{TemplateBinding BorderBrush}"
						BorderThickness="{TemplateBinding BorderThickness}"
						CornerRadius="{TemplateBinding CornerRadius}">
					<ItemsPresenter Name="PART_ItemsPresenter"
									ItemsPanel="{TemplateBinding ItemsPanel}"
									KeyboardNavigation.TabNavigation="Continue" />
				</Border>
			</ControlTemplate>
		</Setter>
	</ControlTheme>
</ResourceDictionary>
